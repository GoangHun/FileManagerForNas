# 기술 아키텍처

본 문서는 AI 파일 관리 시스템의 기술 스택과 아키텍처에 대한 내용을 기술합니다.

## 백엔드 (Backend)

백엔드 API 서버는 Python 기반으로 구축되며, 다음과 같은 핵심 기술을 사용합니다.

### 1. FastAPI

- **설명:** FastAPI는 Python 3.7+ 버전을 기반으로 하는 현대적이고 빠른 고성능 웹 프레임워크입니다. ASGI(Asynchronous Server Gateway Interface)를 기반으로 하여 비동기 요청을 효율적으로 처리할 수 있습니다.

- **선정 이유:**
  - **뛰어난 성능:** Python 웹 프레임워크 중 가장 빠른 속도를 제공하여, 많은 동시 요청을 처리해야 하는 파일 시스템 API에 적합합니다.
  - **비동기 지원:** 파일 I/O와 같이 대기 시간이 긴 작업을 비동기적으로 처리하여 서버의 블로킹(blocking)을 막고 전반적인 응답성을 향상시킵니다.
  - **자동 API 문서:** 코드 작성 시 Swagger UI 및 ReDoc 형태의 대화형 API 문서가 자동으로 생성되어, 프론트엔드 개발 및 API 테스트에 매우 유용합니다.
  - **개발 생산성 및 안정성:** Python의 타입 힌트를 활용하여 코드의 명확성을 높이고, Pydantic을 통한 강력한 데이터 유효성 검사로 런타임 에러를 줄여줍니다.

### 2. Uvicorn

- **설명:** Uvicorn은 FastAPI와 같은 ASGI 애플리케이션을 위한 초고속(lightning-fast) ASGI 서버입니다.

- **선정 이유:**
  - **FastAPI와의 호환성:** FastAPI 프레임워크가 공식적으로 권장하는 ASGI 서버로, 최고의 호환성과 성능을 보장합니다.
  - **높은 성능:** 이름에서 알 수 있듯이 매우 빠른 속도를 자랑하며, FastAPI의 비동기 성능을 최대한으로 활용할 수 있게 해줍니다.

### 관계 요약

**FastAPI**는 웹 애플리케이션을 구축하기 위한 "설계도" 또는 "프레임워크"이며, **Uvicorn**은 이 설계도로 만들어진 애플리케이션을 실제로 웹상에서 실행하고 외부 요청을 처리하는 "서버"입니다. 이 둘의 관계는 PHP 프레임워크인 **Laravel**과 이를 실행하는 웹 서버인 **Apache** 또는 **Nginx**의 관계와 유사합니다.

## AI 기반 스마트 검색 아키텍처

AI 기반 스마트 검색 기능 구현을 위해 다음과 같은 핵심 기술 스택과 아키텍처를 선정했습니다. 이 아키텍처는 단순 키워드 매칭을 넘어선 **의미론적 검색**을 가능하게 합니다.

### 1. 문맥 임베딩 (Contextual Embeddings)

- **설명:** 문맥 임베딩은 단어나 문장의 의미를 주변 문맥과 함께 파악하여 다차원 벡터 공간의 한 점으로 표현하는 기술입니다. 전통적인 키워드 기반 검색이 단어의 일치 여부에만 의존하는 반면, 문맥 임베딩은 "자동차"와 "차량"처럼 의미는 유사하지만 단어는 다른 경우에도 높은 유사도를 가질 수 있도록 합니다. 이를 통해 사용자의 자연어 쿼리가 문서 내의 정확한 단어를 포함하지 않더라도, 의미적으로 관련된 내용을 찾아낼 수 있습니다.

- **중요성:** 파일 관리 시스템에서 사용자가 "작년에 제주도에서 찍은 바다 사진 찾아줘"와 같은 자연어 쿼리를 입력했을 때, 시스템이 단순히 '바다', '사진'이라는 키워드만 찾는 것이 아니라, '제주도', '작년'과 같은 시간적, 공간적 문맥을 이해하여 가장 관련성 높은 파일을 찾아주는 데 필수적입니다.

### 2. `sentence-transformers` 라이브러리

- **설명:** `sentence-transformers`는 문장, 문단 또는 이미지와 같은 다양한 데이터 타입을 고정된 크기의 벡터(임베딩)로 변환하는 데 사용되는 Python 라이브러리입니다. 사전 학습된 트랜스포머 모델을 활용하여 고품질의 문맥 임베딩을 효율적으로 생성합니다.

- **선정 이유:**
  - **높은 품질의 임베딩:** 최신 트랜스포머 모델(예: BERT, RoBERTa)을 기반으로 하여, 문장의 의미를 정확하게 포착하는 고품질 벡터를 생성합니다.
  - **뛰어난 사용 편의성:** 복잡한 AI 모델링 지식 없이도 몇 줄의 코드로 사전 학습된 모델을 로드하고 텍스트를 임베딩할 수 있는 간결한 API를 제공하여 개발 생산성을 극대화합니다.
  - **다양한 사전 학습 모델 지원:** 다국어 및 특정 언어(예: 한국어)에 최적화된 모델들을 폭넓게 지원하여, 시스템 요구사항에 맞는 모델을 유연하게 선택할 수 있습니다.

### 3. 임베딩 모델: `BM-K/KoSimCSE-roberta`

- **설명:** `BM-K/KoSimCSE-roberta`는 한국어 문장 임베딩에 특화된 사전 학습 모델입니다. `SimCSE` 학습 방식을 `RoBERTa` 아키텍처에 적용하여, 한국어 문장의 의미적 유사성을 매우 효과적으로 포착하도록 훈련되었습니다. 이 모델은 특히 한국어 텍스트의 미묘한 뉘앙스를 이해하고, 높은 정확도로 문장 간의 유사도를 측정하는 데 강점을 가집니다.

- **선정 이유:**
  - **한국어 특화 성능:** 기존의 다국어 범용 모델(`paraphrase-multilingual-MiniLM-L12-v2`)이 한국어 문맥을 충분히 이해하지 못하여 검색 관련성이 떨어지는 문제를 해결하기 위해, 한국어에 최적화된 이 모델을 채택했습니다.
  - **높은 정확도:** 한국어 의미론적 유사성(STS) 벤치마크에서 우수한 성능을 보여, 사용자의 한국어 자연어 쿼리에 대해 더 정확하고 관련성 높은 결과를 제공할 수 있습니다.
  - **`sentence-transformers` 호환성:** `sentence-transformers` 라이브러리와 완벽하게 호환되어 쉽게 통합하고 사용할 수 있습니다.

### 4. `ChromaDB` (벡터 데이터베이스)

- **설명:** `ChromaDB`는 벡터 임베딩을 저장하고, 이들 벡터 간의 유사도를 기반으로 효율적인 검색을 수행하도록 특별히 설계된 오픈소스 벡터 데이터베이스입니다.

- **선정 이유:**
  - **개발자 친화적이고 쉬운 시작:** 별도의 서버 설정 없이 Python 애플리케이션 내에서 인메모리 또는 파일 기반으로 실행될 수 있어, 초기 개발 및 통합 과정이 매우 간단합니다.
  - **벡터 검색에 최적화:** 벡터 임베딩의 저장, 관리 및 고성능 유사도 검색(k-NN) 기능을 기본적으로 제공하여, AI 기반 검색 시스템 구축에 필요한 핵심 기능을 손쉽게 구현할 수 있습니다.
  - **Python 네이티브 API:** Python 개발 환경에 자연스럽게 통합되는 직관적인 클라이언트 라이브러리를 제공하여 개발 효율성을 높입니다.

### 5. 스마트 검색 동작 흐름

사용자가 자연어 쿼리를 입력했을 때, 스마트 검색 기능은 다음과 같은 단계로 동작합니다.

1.  **텍스트 청킹 (Text Chunking):** 파일 전체를 한 번에 임베딩하는 대신, 파일 내용을 일정한 크기(예: 500자)로 나누고 각 청크가 이전/다음 청크와 일부 겹치도록(예: 50자) 분할합니다. 이는 검색 시 특정 문맥을 더 정확하게 찾아내고, 검색 결과의 다양성을 높이는 데 기여합니다.
2.  **쿼리 임베딩 (Query Embedding):** 사용자의 자연어 쿼리(예: "하얀늑대들에서 카셀이 드래곤을 만나는 장면")는 `BM-K/KoSimCSE-roberta` 모델을 사용하여 고차원 벡터로 변환됩니다.
3.  **벡터 유사도 검색 (Vector Similarity Search):** 변환된 쿼리 벡터를 `ChromaDB`에 저장된 파일 청크들의 벡터와 비교하여, 의미적으로 가장 유사한 청크들을 찾아냅니다. `ChromaDB`는 효율적인 k-NN(k-Nearest Neighbors) 알고리즘을 사용하여 이 과정을 수행합니다.
4.  **결과 필터링 및 정제 (Result Filtering & Refinement):** `ChromaDB`에서 반환된 유사 청크들 중, 동일한 파일에서 나온 여러 청크가 있을 경우 가장 유사도가 높은 청크 하나만 선택하여 파일 단위의 중복을 제거합니다. 이는 검색 결과가 다양한 파일에서 나올 수 있도록 보장하며, 사용자에게 가장 관련성 높은 파일 스니펫을 제공합니다.
5.  **결과 반환 (Result Return):** 최종적으로 정제된 검색 결과(파일 경로, 내용 스니펫, 유사도 점수 등)가 사용자에게 반환됩니다.
